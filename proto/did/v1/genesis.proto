syntax = "proto3";
package did.v1;

import "amino/amino.proto";
import "did/v1/params.proto";
import "gogoproto/gogo.proto";

option go_package = "github.com/onsonr/sonr/x/did/types";

// GenesisState defines the module genesis state
message GenesisState {
  // Params defines all the parameters of the module.
  Params params = 1 [(gogoproto.nullable) = false];
}

// Document defines a DID document
message Document {
  string id = 1;
  string controller = 2; // The DID of the controller
  repeated string authentication = 3;
  repeated string assertion_method = 4;
  repeated string capability_delegation = 5;
  repeated string capability_invocation = 6;
  repeated string service = 7;
}

// PubKey defines a public key for a did
message PubKey {
  string role = 1;
  string key_type = 2;
  RawKey raw_key = 3;
  JSONWebKey jwk = 4;
}

// JWK represents a JSON Web Key
message JSONWebKey {
  string kty = 1; // Key Type
  string crv = 2; // Curve (for EC and OKP keys)
  string x = 3; // X coordinate (for EC and OKP keys)
  string y = 4; // Y coordinate (for EC keys)
  string n = 5; // Modulus (for RSA keys)
  string e = 6; // Exponent (for RSA keys)
}

message RawKey {
  string algorithm = 1;
  string encoding = 2;
  string curve = 3;
  bytes key = 4;
}
